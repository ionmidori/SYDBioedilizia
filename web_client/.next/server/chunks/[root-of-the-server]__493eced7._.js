module.exports=[18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},55742,e=>e.a(async(r,t)=>{try{let r=await e.y("firebase-admin/firestore");e.n(r),t()}catch(e){t(e)}},!0),56300,e=>e.a(async(r,t)=>{try{let r=await e.y("firebase-admin/app");e.n(r),t()}catch(e){t(e)}},!0),94222,e=>e.a(async(r,t)=>{try{let r=await e.y("firebase-admin/storage");e.n(r),t()}catch(e){t(e)}},!0),36444,e=>e.a(async(r,t)=>{try{let d,v,_;var s=e.i(56300),i=e.i(55742),n=e.i(94222),a=r([s,i,n]);function o(e){if(!e)throw Error("[Firebase] Private key is missing");let r=e.replace(/\\n/g,"\n");if(r.startsWith('"')&&r.endsWith('"')&&(r=r.slice(1,-1)),r.startsWith("'")&&r.endsWith("'")&&(r=r.slice(1,-1)),console.log("[Firebase] Debug Key:",{length:r.length,hasNewlines:r.includes("\n"),startsWith:r.substring(0,30),endsWith:r.substring(r.length-30),dotCount:(r.match(/\./g)||[]).length}),!r.includes("BEGIN PRIVATE KEY")||!r.includes("END PRIVATE KEY"))throw Error("[Firebase] Invalid private key format - must be a valid RSA private key (PEM format)");let t=r.split("BEGIN PRIVATE KEY")[1]?.split("END PRIVATE KEY")[0];if(!t||t.trim().length<100)throw Error("[Firebase] Private key appears to be truncated or empty");if(!r.includes("\n"))throw Error("[Firebase] Private key invalid: missing newlines after sanitization");return r}function c(e,r){if(!e||!e.includes("@")||!e.endsWith(".gserviceaccount.com"))throw Error(`[Firebase] Invalid service account email: ${e} - must end with .gserviceaccount.com`);if(!r||r.length<6||!/^[a-z0-9-]+$/.test(r))throw Error(`[Firebase] Invalid project ID: ${r} - must contain only lowercase letters, numbers, and hyphens`)}function l(){if(0===(0,s.getApps)().length){console.log("[Firebase] Initializing Firebase Admin SDK...");try{let r=process.env.FIREBASE_PRIVATE_KEY;if(r&&process.env.FIREBASE_CLIENT_EMAIL&&process.env.FIREBASE_PROJECT_ID){console.log("[Firebase] Loading credentials from environment variables");let e=o(r);return c(process.env.FIREBASE_CLIENT_EMAIL,process.env.FIREBASE_PROJECT_ID),d=(0,s.initializeApp)({credential:(0,s.cert)({projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:e}),storageBucket:process.env.FIREBASE_STORAGE_BUCKET||`${process.env.FIREBASE_PROJECT_ID}.firebasestorage.app`}),console.log("[Firebase] ✅ Successfully initialized from environment variables"),d}let t=e.r(22734),i=e.r(14747).join(process.cwd(),"firebase-service-account.json");if(console.log("[Firebase] Loading credentials from:",i),!t.existsSync(i))throw Error(`Firebase service account file not found at: ${i}. Please ensure firebase-service-account.json exists in the project root OR set environment variables.`);let n=JSON.parse(t.readFileSync(i,"utf8")),a=o(n.private_key);return c(n.client_email,n.project_id),d=(0,s.initializeApp)({credential:(0,s.cert)({...n,private_key:a}),storageBucket:n.project_id+".firebasestorage.app"}),console.log("[Firebase] ✅ Successfully initialized from JSON file"),d}catch(e){throw console.error("[Firebase] ❌ Initialization FAILED:",e),e}}return(0,s.getApps)()[0]}function u(){if(!v){let e=l();v=(0,i.getFirestore)(e)}return v}function p(){if(!_){let e=l();_=(0,n.getStorage)(e)}return _}[s,i,n]=a.then?(await a)():a,e.s(["db",0,u,"getFirebaseStorage",()=>p,"getFirestoreDb",()=>u,"storage",0,p]),t()}catch(e){t(e)}},!1),14747,(e,r,t)=>{r.exports=e.x("path",()=>require("path"))},22734,(e,r,t)=>{r.exports=e.x("fs",()=>require("fs"))},46786,(e,r,t)=>{r.exports=e.x("os",()=>require("os"))},84199,(e,r,t)=>{"use strict";var s=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,o={},c={VercelOidcTokenError:()=>u};for(var l in c)s(o,l,{get:c[l],enumerable:!0});r.exports=((e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let t of n(r))a.call(e,t)||void 0===t||s(e,t,{get:()=>r[t],enumerable:!(o=i(r,t))||o.enumerable});return e})(s({},"__esModule",{value:!0}),o);class u extends Error{constructor(e,r){super(e),this.name="VercelOidcTokenError",this.cause=r}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},24361,(e,r,t)=>{r.exports=e.x("util",()=>require("util"))},59639,(e,r,t)=>{r.exports=e.x("node:process",()=>require("node:process"))},874,(e,r,t)=>{r.exports=e.x("buffer",()=>require("buffer"))},12057,(e,r,t)=>{r.exports=e.x("node:util",()=>require("node:util"))},54799,(e,r,t)=>{r.exports=e.x("crypto",()=>require("crypto"))},78292,e=>e.a(async(r,t)=>{try{let l,u;var s=e.i(56300),i=e.i(55742),n=e.i(94222),a=r([s,i,n]);function o(e){if(!e)throw Error("[Firebase] Private key is missing");let r=e.replace(/\\n/g,"\n");if(r.startsWith('"')&&r.endsWith('"')&&(r=r.slice(1,-1)),r.startsWith("'")&&r.endsWith("'")&&(r=r.slice(1,-1)),!r.includes("BEGIN PRIVATE KEY")||!r.includes("END PRIVATE KEY"))throw Error("[Firebase] Invalid private key format - must be a valid RSA private key (PEM format)");let t=r.split("BEGIN PRIVATE KEY")[1]?.split("END PRIVATE KEY")[0];if(!t||t.trim().length<100)throw Error("[Firebase] Private key appears to be truncated or empty");if(!r.includes("\n"))throw Error("[Firebase] Private key invalid: missing newlines after sanitization");return r}function c(e,r){if(!e||!e.includes("@")||!e.endsWith(".gserviceaccount.com"))throw Error(`[Firebase] Invalid service account email: ${e} - must end with .gserviceaccount.com`);if(!r||r.length<6||!/^[a-z0-9-]+$/.test(r))throw Error(`[Firebase] Invalid project ID: ${r} - must contain only lowercase letters, numbers, and hyphens`)}[s,i,n]=a.then?(await a)():a,e.s(["db",0,function(){if(!u){let r=function(){if(0===(0,s.getApps)().length){console.log("[Firebase] Initializing Firebase Admin SDK...");try{let r=process.env.FIREBASE_PRIVATE_KEY;if(r&&process.env.FIREBASE_CLIENT_EMAIL&&process.env.FIREBASE_PROJECT_ID){console.log("[Firebase] Loading credentials from environment variables");let e=o(r);return c(process.env.FIREBASE_CLIENT_EMAIL,process.env.FIREBASE_PROJECT_ID),l=(0,s.initializeApp)({credential:(0,s.cert)({projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:e}),storageBucket:`${process.env.FIREBASE_PROJECT_ID}.firebasestorage.app`}),console.log("[Firebase] ✅ Successfully initialized from environment variables"),l}let t=e.r(22734),i=e.r(14747).join(process.cwd(),"firebase-service-account.json");if(console.log("[Firebase] Loading credentials from:",i),!t.existsSync(i))throw Error(`Firebase service account file not found at: ${i}. Please ensure firebase-service-account.json exists in the project root OR set environment variables.`);let n=JSON.parse(t.readFileSync(i,"utf8")),a=o(n.private_key);return c(n.client_email,n.project_id),l=(0,s.initializeApp)({credential:(0,s.cert)({...n,private_key:a}),storageBucket:n.project_id+".firebasestorage.app"}),console.log("[Firebase] ✅ Successfully initialized from JSON file"),l}catch(e){throw console.error("[Firebase] ❌ Initialization FAILED:",e),e}}return(0,s.getApps)()[0]}();u=(0,i.getFirestore)(r)}return u}]),t()}catch(e){t(e)}},!1),18737,e=>e.a(async(r,t)=>{try{var s=e.i(78292),i=e.i(55742),n=r([s,i]);[s,i]=n.then?(await n)():n;let c=(0,s.db)(),l=new Map,u=null;async function a(e){return console.log("[RateLimit] Checking Firestore for IP:",e),await o(e)}async function o(e){let r=c.collection("rate_limits").doc(e),t=await c.runTransaction(async e=>{let t=await e.get(r),s=Date.now();if(!t.exists)return e.set(r,{count:1,windowStart:i.Timestamp.fromMillis(s),lastRequest:i.Timestamp.fromMillis(s)}),{allowed:!0,remaining:19,resetAt:s+6e4};let n=t.data(),a=n.windowStart.toMillis();return s-a>=6e4?(e.update(r,{count:1,windowStart:i.Timestamp.fromMillis(s),lastRequest:i.Timestamp.fromMillis(s)}),{allowed:!0,remaining:19,resetAt:s+6e4}):n.count>=20?{allowed:!1,remaining:0,resetAt:a+6e4}:(e.update(r,{count:n.count+1,lastRequest:i.Timestamp.fromMillis(s)}),{allowed:!0,remaining:20-(n.count+1),resetAt:a+6e4})});return{...t,resetAt:new Date(t.resetAt)}}u=setInterval(()=>{let e=Date.now();for(let[r,t]of l.entries())e-t.timestamp>1e4&&l.delete(r)},3e4),console.log("[RateLimit] Cache cleanup interval initialized"),process.on("beforeExit",()=>{u&&(clearInterval(u),u=null,console.log("[RateLimit] Cache cleanup interval cleared"))}),e.s(["checkRateLimit",()=>a]),t()}catch(e){t(e)}},!1),67030,e=>{e.v(r=>Promise.all(["server/chunks/node_modules_@vercel_oidc_dist_7c2bef69._.js"].map(r=>e.l(r))).then(()=>r(83697)))},83671,e=>{e.v(r=>Promise.all(["server/chunks/node_modules_@vercel_oidc_dist_7fd3d757._.js"].map(r=>e.l(r))).then(()=>r(90391)))},85685,e=>{e.v(e=>Promise.resolve().then(()=>e(54799)))},91961,e=>{e.v(e=>Promise.resolve().then(()=>e(12111)))},74626,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__301c55ae._.js","server/chunks/[root-of-the-server]__a028253d._.js","server/chunks/50665_node-fetch_src_index_19cc86e6.js"].map(r=>e.l(r))).then(()=>r(70761)))},26154,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__15451b96._.js","server/chunks/[root-of-the-server]__a028253d._.js","server/chunks/08abe_node-fetch_src_index_186633b9.js"].map(r=>e.l(r))).then(()=>r(56912)))},66113,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__15d484fe._.js","server/chunks/[root-of-the-server]__a028253d._.js","server/chunks/5b134_node-fetch_src_index_b8c5600c.js"].map(r=>e.l(r))).then(()=>r(47302)))},11193,e=>{e.v(r=>Promise.all(["server/chunks/ai_core_src_vision_triage_ts_077e289f._.js"].map(r=>e.l(r))).then(()=>r(63925)))},45867,e=>{e.v(r=>Promise.all(["server/chunks/ai_core_src_imagen_generator_ts_bb828f04._.js"].map(r=>e.l(r))).then(()=>r(5023)))},40900,e=>{e.v(r=>Promise.all(["server/chunks/ai_core_src_storage_upload_ts_7e4c6b11._.js"].map(r=>e.l(r))).then(()=>r(52887)))},57755,e=>{e.v(r=>Promise.all(["server/chunks/ai_core_src_db_quotes_ts_6cfc3201._.js"].map(r=>e.l(r))).then(()=>r(31877)))},45890,e=>{e.v(e=>Promise.resolve().then(()=>e(55742)))},72224,e=>{e.v(e=>Promise.resolve().then(()=>e(36444)))},79911,e=>{e.v(r=>Promise.all(["server/chunks/ai_core_src_index_ts_287e54fa._.js"].map(r=>e.l(r))).then(()=>r(6825)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__493eced7._.js.map